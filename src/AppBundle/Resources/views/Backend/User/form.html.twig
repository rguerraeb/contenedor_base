{% set currentPath = path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')) %}

<form method="post" action="" id="userForm" class="validateForm"
	autocomplete="false">
		<div class="row">
			<div class="col-md-6">
				<div class="form-group">
					{{ form_label(form.firstName, "Nombres") }}
					{{form_widget(form.firstName, {'attr': {'class': 'required form-control' }}) }}
				</div>
			</div>
			<div class="col-md-6">
				<div class="form-group">
					{{ form_label(form.lastName, "Apellidos") }}
					{{form_widget(form.lastName, {'attr': {'class': 'required form-control' }}) }}
				</div>
			</div>
			<div class="col-md-6">
				<div class="form-group">
					{{ form_label(form.email, "Email") }}
					{{form_widget(form.email, {'attr': {'class': 'required email form-control' }}) }}
				</div>
			</div>
			<div class="col-md-6">
				<div class="form-group">
				    {{ form_label(form.password, "Contrase√±a") }}
				    {{form_widget(form.password, {'attr': {'class': 'form-control' }}) }}
				</div>
			</div>
			<div class="col-md-6">
				<div class="form-group">
					{{ form_label(form.status, "Estado") }}
					{{form_widget(form.status, {'attr': {'class': 'required form-control' }}) }}
				</div>
			</div>
			<div class="col-md-6">
				<div class="form-group">
					{{ form_label(form.userRole, "Rol") }}
					{{form_widget(form.userRole, {'attr': {'class': 'required form-control'}}) }}
				</div>
			</div>	
			<div class="col-md-6">
				<div class="form-group select-distributor">
					{{ form_label(form.distributor, "Asignar a tienda") }}
					{{form_widget(form.distributor, {'attr': {'class': 'form-control'}}) }}
				</div>
			</div>	
			<div class="col-md-6">
			</div>	
			<div class="col-md-6">
				{% if 'edit' in currentPath %}
					<button type="reset" onclick="window.location='{{ path('backend_user') }}'" class="btn btn-rounded btn-danger">Cancelar</button>
				{% else %}
					<button type="reset" data-dismiss="modal" class="btn btn-rounded btn-danger">Cancelar</button>
				{% endif %}
			</div>
			<div class="col-md-6">
				<button id="button-save" type="submit" class="btn btn-rounded btn-success float-right" style="margin-right: 0px;">Guardar Datos</button>
			</div>	
			<!-- /.col -->
		</div>
		<!-- /.row -->
	{{ form_widget(form._token) }}
</form>


{% block extra_scripts %}

	<script>

		$(document).ready(function(){
			var rol = $('#user_userRole').val();
			
			if (rol == 5) {
				$('.select-distributor').show();
			} else if (rol == 4) {
				$('.select-distributor').hide();
			} else {
				$('.select-distributor').hide();
			}

			$('#user_userRole').change(function(){
				var rol = $('#user_userRole').val();

				if (rol == 5) {
					$('.select-distributor').show();
					$('#user_distributor').addClass("required");
				} else if (rol == 4) {
					$('.select-distributor').hide();
					$('#user_distributor').removeClass("required");
				}
			});

			$('#userForm').validate({
				submitHandler: function(form) {
					var saveButton = document.getElementById("button-save");
					var validateForm = document.getElementById("userForm");
					saveButton.setAttribute("disabled", true);
					saveButton.innerHTML = "<span class='spinner-border spinner-border-sm' role='status'></span> Cargando...";
					var elements = validateForm.elements;
					for (var i = 0, len = elements.length; i < len; ++i) {
						elements[i].readOnly = true;
					}
					document.getElementById("userForm").submit();
				}
			});

		});

	</script>

{% endblock %}